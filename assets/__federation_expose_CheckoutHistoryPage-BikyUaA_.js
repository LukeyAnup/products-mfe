import{importShared as d}from"./__federation_fn_import-eoakS9EZ.js";import{_ as g}from"./responseHandler-DkRXjDjr.js";import{j as t}from"./jsx-runtime-BjG_zV1W.js";/* empty css              */import{f as k,L as N,E as w}from"./error-BJAHachG.js";import{I as b}from"./image-DmEqM-8I.js";import{g as v}from"./checkoutApi-CdL_HDGU.js";const{useState:l,useEffect:H}=await d("react"),{toast:_}=await d("react-toastify"),E=await g("authMFE","./AuthProvider");let{useAuth:O}=E;const{useTranslation:P}=await d("react-i18next");function M(){const{user:o,isAuthenticated:n}=O(),{t:s}=P(),[m,i]=l(!0),[u,h]=l(null),[r,x]=l([]);H(()=>{n&&o?.id?f():i(!1)},[o,n]);const f=async()=>{if(o?.id)try{i(!0);const[e,c]=await Promise.all([v(o.id),k()]);if(!e.status||!e.data){h(e.message||s("checkoutHistory.error"));return}const y=e.data.map(a=>({...c.find(j=>j.id===a.productId),checkoutId:a.id,quantity:a.quantity,checkedOutAt:a.checkedOutAt}));x(y),h(null)}catch(e){console.error(e),_.error(s("checkoutHistory.toastError"))}finally{i(!1)}};if(!n)return t.jsx("div",{className:"flex flex-col justify-center items-center min-h-screen gap-4",children:t.jsx("h2",{className:"text-2xl font-bold",children:s("checkoutHistory.loginToView")})});if(m)return t.jsx(N,{});if(u)return t.jsx(w,{message:u,onRetry:()=>window.location.reload()});if(r.length===0)return t.jsxs("div",{className:"flex flex-col justify-center items-center min-h-screen gap-4",children:[t.jsx("h2",{className:"text-2xl font-bold",children:s("checkoutHistory.noOrders")}),t.jsx("p",{className:"text-gray-600",children:s("checkoutHistory.noOrdersDesc")})]});const p=r.reduce((e,c)=>e+c.price*c.quantity,0);return t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsx("h2",{className:"text-3xl font-bold mb-6",children:s("checkoutHistory.title",{count:r.length})}),t.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:t.jsxs("p",{className:"text-lg font-semibold",children:[s("checkoutHistory.totalSpent")," $",p.toFixed(2)]})}),t.jsx("div",{className:"space-y-4",children:r.map(e=>t.jsxs("div",{className:"bg-white p-6 flex flex-col md:flex-row gap-4 rounded-2xl shadow-md",children:[t.jsx("div",{className:"w-full md:w-32 h-32 shrink-0",children:t.jsx(b,{loading:"lazy",alt:e.title,src:e.images?.[0],className:"w-full h-full object-contain"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-bold text-lg",children:e.title}),t.jsx("p",{className:"text-gray-600 text-sm mt-2 line-clamp-2",children:e.description}),t.jsxs("div",{className:"mt-3",children:[t.jsxs("p",{className:"text-sm text-gray-500",children:[s("checkoutHistory.orderedOn")," ",new Date(e.checkedOutAt).toLocaleDateString()]}),t.jsxs("p",{className:"font-semibold mt-1",children:[s("checkoutHistory.quantity"),": ",e.quantity]}),t.jsxs("p",{className:"font-bold text-lg mt-1",children:[s("checkoutHistory.total"),": $",(e.price*e.quantity).toFixed(2)]})]})]})]},e.checkoutId))})]})}export{M as default};
